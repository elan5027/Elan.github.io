---
layout: post
bigtitle:  "Team 프로젝트 - B4조"
subtitle:   "project"
categories:
    - project
    - team
tags:
  - project
  - team
comments: true
published: true
---
# Team 프로젝트 - B4조 

## 발생한 문제

머신러닝 프로젝트 배포시 Killed (프로세스가 자동으로 꺼짐) 현상이 발생햇다.
이로 인하여 dmesg를 통해 로그를 확인 한 결과 Out of memory가 발생햇다.

1. 이미지 머신러닝의 특성상 학습모델 자체가 부담하는 메모리가 많다.
2. 프리티어의 배포환경은 1기가의 메모리를 지원한다.
3. 머신러닝의 학습 환경 저장파일은 1.2기가이다.


## 해결한 방법

우선 리눅스 배포환경에서 스왑메모리를 할당하여 성능을 조금 포기하여 보았다.

Swap 메모리를 할당한 결과 VGG19 모델 자체는 잘 받아오지만 해당 모델에
학습된 모델이 정보를 로드시키는 과정에서 프로그렘이 죽는 현상이 발생하는 것같다.
때문에 정상적으로 동작 시키기 위해서는 추가적인 비용을 소모하여 메모리를 할당해야 한다.

### Swap 메모리란?

- 가상 메모리 구현 방식중 하나.
- 물리적 메모리가 부족할 때 사용될 메모리를 추가적으로 자원 할당을 위해 사용.
- 일반적으로 하드 드라이브나 SSD를 사용하면 RAM보다 속도가 느리다

### Swap 메모리 동작원리

- 물리적 메모리가 부족할 경우 사용되지 않는 페이지를 swap 메모리로 이동시킨다.
- 해당 페이지가 다시 필요한 경우, swap 메모리에서 물리적 메모리로 페이지를 로드한다.


### Swap 메모리 필요성

- 메모리 부족 상황에서 시스템 성능을 유지하고 프로세스 실행을 지원
- 비활성화된 프로세스의 메모리를 임시로 저장하여 물리적 메모리를 효율적으로 사용

### Swap 메모리 할당 방법

EC2의 프리티어는 기본 메모리가 1GB 이므로 해당의 2배인 2G로 할당해야 한다.

1. sudo dd if=/dev/zero of=/swapfile bs=128M count=16

생성된 Swap 파일에 대한 권한 업데이트
2. sudo chmod 600 /swapfile

Swap 영역 설정
3. sudo mkswap /swapfile

Swap 파일 생성
4. sudo swapon /swapfile

Swap 파일 확인
5. sudo swapon -s

재부팅 해도 계속 활성화하게 fstap에 추가
6. sudo vi /etc/fstap
/swapfile swap defaults 0 0 

top, free 명령어로 메모리 할당확인.




## 문제를 통해 느낀점

1. 머신러닝을 웹 페이지에서 동작시키기 위해선 생각보다 큰 메모리를 소모한다.
2. 머신러닝을 서버단에서 로드하지 않고 동작 시키는 방법이 있을지 찾아보아야겟다.
3. 메모리를 최소한으로 모듈을 받아오는 방법을 찾아보아야 겟다.
4. 백엔드의 기능 뿐만이 아니라 하드웨어적인 한계도 발생할 수 있다는걸 확인햇다.

